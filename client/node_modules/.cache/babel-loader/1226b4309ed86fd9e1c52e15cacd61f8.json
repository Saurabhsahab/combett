{"ast":null,"code":"/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * \n * @emails oncall+draft_js\n */\n'use strict';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar UserAgent = require(\"fbjs/lib/UserAgent\");\n\nvar findAncestorOffsetKey = require(\"./findAncestorOffsetKey\");\n\nvar getWindowForNode = require(\"./getWindowForNode\");\n\nvar Immutable = require(\"immutable\");\n\nvar invariant = require(\"fbjs/lib/invariant\");\n\nvar nullthrows = require(\"fbjs/lib/nullthrows\");\n\nvar Map = Immutable.Map; // Heavily based on Prosemirror's DOMObserver https://github.com/ProseMirror/prosemirror-view/blob/master/src/domobserver.js\n\nvar DOM_OBSERVER_OPTIONS = {\n  subtree: true,\n  characterData: true,\n  childList: true,\n  characterDataOldValue: false,\n  attributes: false\n}; // IE11 has very broken mutation observers, so we also listen to DOMCharacterDataModified\n\nvar USE_CHAR_DATA = UserAgent.isBrowser('IE <= 11');\n\nvar DOMObserver = /*#__PURE__*/function () {\n  function DOMObserver(container) {\n    var _this = this;\n\n    _defineProperty(this, \"observer\", void 0);\n\n    _defineProperty(this, \"container\", void 0);\n\n    _defineProperty(this, \"mutations\", void 0);\n\n    _defineProperty(this, \"onCharData\", void 0);\n\n    this.container = container;\n    this.mutations = Map();\n    var containerWindow = getWindowForNode(container);\n\n    if (containerWindow.MutationObserver && !USE_CHAR_DATA) {\n      this.observer = new containerWindow.MutationObserver(function (mutations) {\n        return _this.registerMutations(mutations);\n      });\n    } else {\n      this.onCharData = function (e) {\n        !(e.target instanceof Node) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Expected target to be an instance of Node') : invariant(false) : void 0;\n\n        _this.registerMutation({\n          type: 'characterData',\n          target: e.target\n        });\n      };\n    }\n  }\n\n  var _proto = DOMObserver.prototype;\n\n  _proto.start = function start() {\n    if (this.observer) {\n      this.observer.observe(this.container, DOM_OBSERVER_OPTIONS);\n    } else {\n      /* $FlowFixMe[incompatible-call] (>=0.68.0 site=www,mobile) This event\n       * type is not defined by Flow's standard library */\n      this.container.addEventListener('DOMCharacterDataModified', this.onCharData);\n    }\n  };\n\n  _proto.stopAndFlushMutations = function stopAndFlushMutations() {\n    var observer = this.observer;\n\n    if (observer) {\n      this.registerMutations(observer.takeRecords());\n      observer.disconnect();\n    } else {\n      /* $FlowFixMe[incompatible-call] (>=0.68.0 site=www,mobile) This event\n       * type is not defined by Flow's standard library */\n      this.container.removeEventListener('DOMCharacterDataModified', this.onCharData);\n    }\n\n    var mutations = this.mutations;\n    this.mutations = Map();\n    return mutations;\n  };\n\n  _proto.registerMutations = function registerMutations(mutations) {\n    for (var i = 0; i < mutations.length; i++) {\n      this.registerMutation(mutations[i]);\n    }\n  };\n\n  _proto.getMutationTextContent = function getMutationTextContent(mutation) {\n    var type = mutation.type,\n        target = mutation.target,\n        removedNodes = mutation.removedNodes;\n\n    if (type === 'characterData') {\n      // When `textContent` is '', there is a race condition that makes\n      // getting the offsetKey from the target not possible.\n      // These events are also followed by a `childList`, which is the one\n      // we are able to retrieve the offsetKey and apply the '' text.\n      if (target.textContent !== '') {\n        // IE 11 considers the enter keypress that concludes the composition\n        // as an input char. This strips that newline character so the draft\n        // state does not receive spurious newlines.\n        if (USE_CHAR_DATA) {\n          return target.textContent.replace('\\n', '');\n        }\n\n        return target.textContent;\n      }\n    } else if (type === 'childList') {\n      if (removedNodes && removedNodes.length) {\n        // `characterData` events won't happen or are ignored when\n        // removing the last character of a leaf node, what happens\n        // instead is a `childList` event with a `removedNodes` array.\n        // For this case the textContent should be '' and\n        // `DraftModifier.replaceText` will make sure the content is\n        // updated properly.\n        return '';\n      } else if (target.textContent !== '') {\n        // Typing Chinese in an empty block in MS Edge results in a\n        // `childList` event with non-empty textContent.\n        // See https://github.com/facebook/draft-js/issues/2082\n        return target.textContent;\n      }\n    }\n\n    return null;\n  };\n\n  _proto.registerMutation = function registerMutation(mutation) {\n    var textContent = this.getMutationTextContent(mutation);\n\n    if (textContent != null) {\n      var offsetKey = nullthrows(findAncestorOffsetKey(mutation.target));\n      this.mutations = this.mutations.set(offsetKey, textContent);\n    }\n  };\n\n  return DOMObserver;\n}();\n\nmodule.exports = DOMObserver;","map":{"version":3,"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","UserAgent","require","findAncestorOffsetKey","getWindowForNode","Immutable","invariant","nullthrows","Map","DOM_OBSERVER_OPTIONS","subtree","characterData","childList","characterDataOldValue","attributes","USE_CHAR_DATA","isBrowser","DOMObserver","container","_this","mutations","containerWindow","MutationObserver","observer","registerMutations","onCharData","e","target","Node","process","env","NODE_ENV","registerMutation","type","_proto","prototype","start","observe","addEventListener","stopAndFlushMutations","takeRecords","disconnect","removeEventListener","i","length","getMutationTextContent","mutation","removedNodes","textContent","replace","offsetKey","set","module","exports"],"sources":["/home/sudhanshu/Documents/combett/node_modules/draft-js/lib/DOMObserver.js"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * \n * @emails oncall+draft_js\n */\n'use strict';\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar UserAgent = require(\"fbjs/lib/UserAgent\");\n\nvar findAncestorOffsetKey = require(\"./findAncestorOffsetKey\");\n\nvar getWindowForNode = require(\"./getWindowForNode\");\n\nvar Immutable = require(\"immutable\");\n\nvar invariant = require(\"fbjs/lib/invariant\");\n\nvar nullthrows = require(\"fbjs/lib/nullthrows\");\n\nvar Map = Immutable.Map;\n// Heavily based on Prosemirror's DOMObserver https://github.com/ProseMirror/prosemirror-view/blob/master/src/domobserver.js\nvar DOM_OBSERVER_OPTIONS = {\n  subtree: true,\n  characterData: true,\n  childList: true,\n  characterDataOldValue: false,\n  attributes: false\n}; // IE11 has very broken mutation observers, so we also listen to DOMCharacterDataModified\n\nvar USE_CHAR_DATA = UserAgent.isBrowser('IE <= 11');\n\nvar DOMObserver = /*#__PURE__*/function () {\n  function DOMObserver(container) {\n    var _this = this;\n\n    _defineProperty(this, \"observer\", void 0);\n\n    _defineProperty(this, \"container\", void 0);\n\n    _defineProperty(this, \"mutations\", void 0);\n\n    _defineProperty(this, \"onCharData\", void 0);\n\n    this.container = container;\n    this.mutations = Map();\n    var containerWindow = getWindowForNode(container);\n\n    if (containerWindow.MutationObserver && !USE_CHAR_DATA) {\n      this.observer = new containerWindow.MutationObserver(function (mutations) {\n        return _this.registerMutations(mutations);\n      });\n    } else {\n      this.onCharData = function (e) {\n        !(e.target instanceof Node) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Expected target to be an instance of Node') : invariant(false) : void 0;\n\n        _this.registerMutation({\n          type: 'characterData',\n          target: e.target\n        });\n      };\n    }\n  }\n\n  var _proto = DOMObserver.prototype;\n\n  _proto.start = function start() {\n    if (this.observer) {\n      this.observer.observe(this.container, DOM_OBSERVER_OPTIONS);\n    } else {\n      /* $FlowFixMe[incompatible-call] (>=0.68.0 site=www,mobile) This event\n       * type is not defined by Flow's standard library */\n      this.container.addEventListener('DOMCharacterDataModified', this.onCharData);\n    }\n  };\n\n  _proto.stopAndFlushMutations = function stopAndFlushMutations() {\n    var observer = this.observer;\n\n    if (observer) {\n      this.registerMutations(observer.takeRecords());\n      observer.disconnect();\n    } else {\n      /* $FlowFixMe[incompatible-call] (>=0.68.0 site=www,mobile) This event\n       * type is not defined by Flow's standard library */\n      this.container.removeEventListener('DOMCharacterDataModified', this.onCharData);\n    }\n\n    var mutations = this.mutations;\n    this.mutations = Map();\n    return mutations;\n  };\n\n  _proto.registerMutations = function registerMutations(mutations) {\n    for (var i = 0; i < mutations.length; i++) {\n      this.registerMutation(mutations[i]);\n    }\n  };\n\n  _proto.getMutationTextContent = function getMutationTextContent(mutation) {\n    var type = mutation.type,\n        target = mutation.target,\n        removedNodes = mutation.removedNodes;\n\n    if (type === 'characterData') {\n      // When `textContent` is '', there is a race condition that makes\n      // getting the offsetKey from the target not possible.\n      // These events are also followed by a `childList`, which is the one\n      // we are able to retrieve the offsetKey and apply the '' text.\n      if (target.textContent !== '') {\n        // IE 11 considers the enter keypress that concludes the composition\n        // as an input char. This strips that newline character so the draft\n        // state does not receive spurious newlines.\n        if (USE_CHAR_DATA) {\n          return target.textContent.replace('\\n', '');\n        }\n\n        return target.textContent;\n      }\n    } else if (type === 'childList') {\n      if (removedNodes && removedNodes.length) {\n        // `characterData` events won't happen or are ignored when\n        // removing the last character of a leaf node, what happens\n        // instead is a `childList` event with a `removedNodes` array.\n        // For this case the textContent should be '' and\n        // `DraftModifier.replaceText` will make sure the content is\n        // updated properly.\n        return '';\n      } else if (target.textContent !== '') {\n        // Typing Chinese in an empty block in MS Edge results in a\n        // `childList` event with non-empty textContent.\n        // See https://github.com/facebook/draft-js/issues/2082\n        return target.textContent;\n      }\n    }\n\n    return null;\n  };\n\n  _proto.registerMutation = function registerMutation(mutation) {\n    var textContent = this.getMutationTextContent(mutation);\n\n    if (textContent != null) {\n      var offsetKey = nullthrows(findAncestorOffsetKey(mutation.target));\n      this.mutations = this.mutations.set(offsetKey, textContent);\n    }\n  };\n\n  return DOMObserver;\n}();\n\nmodule.exports = DOMObserver;"],"mappings":"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"},"metadata":{},"sourceType":"script"}